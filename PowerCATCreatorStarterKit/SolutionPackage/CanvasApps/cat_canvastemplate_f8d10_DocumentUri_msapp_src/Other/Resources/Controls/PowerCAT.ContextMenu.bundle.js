/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{ContextMenu:()=>m});const n=React;var i={0:"center",1:"left",2:"right"},o=void 0;try{o=window}catch(e){}function r(e){if(void 0!==o){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:o}}var a=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var n=this,i=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),i=setTimeout((function(){try{n._timeoutIds&&delete n._timeoutIds[i],e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._timeoutIds[i]=!0),i},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var n=this,i=0,o=r(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),i=o.setTimeout((function(){try{n._immediateIds&&delete n._immediateIds[i],e.apply(n._parent)}catch(e){n._logError(e)}}),0),this._immediateIds[i]=!0),i},e.prototype.clearImmediate=function(e,t){var n=r(t);this._immediateIds&&this._immediateIds[e]&&(n.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var n=this,i=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),i=setInterval((function(){try{e.apply(n._parent)}catch(e){n._logError(e)}}),t),this._intervalIds[i]=!0),i},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,n){var i=this;if(this._isDisposed)return this._noop;var o,r,a=t||0,s=!0,l=!0,u=0,d=null;n&&"boolean"==typeof n.leading&&(s=n.leading),n&&"boolean"==typeof n.trailing&&(l=n.trailing);var c=function t(n){var c=Date.now(),m=c-u,h=s?a-m:a;return m>=a&&(!n||s)?(u=c,d&&(i.clearTimeout(d),d=null),o=e.apply(i._parent,r)):null===d&&l&&(d=i.setTimeout(t,h)),o};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r=e,c(!0)}},e.prototype.debounce=function(e,t,n){var i=this;if(this._isDisposed){var o=function(){};return o.cancel=function(){},o.flush=function(){return null},o.pending=function(){return!1},o}var r,a,s=t||0,l=!1,u=!0,d=null,c=0,m=Date.now(),h=null;n&&"boolean"==typeof n.leading&&(l=n.leading),n&&"boolean"==typeof n.trailing&&(u=n.trailing),n&&"number"==typeof n.maxWait&&!isNaN(n.maxWait)&&(d=n.maxWait);var p=function(e){h&&(i.clearTimeout(h),h=null),m=e},f=function(t){p(t),r=e.apply(i._parent,a)},I=function e(t){var n=Date.now(),o=!1;t&&(l&&n-c>=s&&(o=!0),c=n);var a=n-c,p=s-a,I=n-m,v=!1;return null!==d&&(I>=d&&h?v=!0:p=Math.min(p,d-I)),a>=s||v||o?f(n):null!==h&&t||!u||(h=i.setTimeout(e,p)),r},v=function(){return!!h},_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a=e,I(!0)};return _.cancel=function(){v()&&p(Date.now())},_.flush=function(){return v()&&f(Date.now()),r},_.pending=v,_},e.prototype.requestAnimationFrame=function(e,t){var n=this,i=0,o=r(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var a=function(){try{n._animationFrameIds&&delete n._animationFrameIds[i],e.apply(n._parent)}catch(e){n._logError(e)}};i=o.requestAnimationFrame?o.requestAnimationFrame(a):o.setTimeout(a,0),this._animationFrameIds[i]=!0}return i},e.prototype.cancelAnimationFrame=function(e,t){var n=r(t);this._animationFrameIds&&this._animationFrameIds[e]&&(n.cancelAnimationFrame?n.cancelAnimationFrame(e):n.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}();const s=FluentUIReactv8290;function l(e){return{id:e,key:e,name:"Item "+e,iconName:"Unknown"}}function u(e,t,n){return e.filter((e=>!e.parentItemKey&&!1!==e.visible)).map((i=>d(e,i,t,n)))}function d(e,t,n,i){var o=e.filter((e=>e.parentItemKey===t.key&&!1!==e.visible)).map((t=>d(e,t,n,i)));return{key:t.key,text:t.name,disabled:!1===t.enabled||n,onClick:i,iconOnly:!0===t.iconOnly,iconProps:{iconName:t.iconName,styles:{root:{color:t.iconColor}}},checked:t.checked,data:t,buttonStyles:{root:{background:"rgba(255, 255, 255,0)"}},subMenuProps:o.length>0?{items:o}:void 0}}var c=n.memo((e=>{var{items:t,onSelected:i,disabled:o,setFocus:r,themeJSON:l,width:d,height:c,showChevron:m,justify:h,tabIndex:p,borderColor:f,backgroundColor:I}=e,v=n.useMemo((()=>{try{return l?(0,s.createTheme)(JSON.parse(l)):void 0}catch(e){console.error("Cannot parse theme",e)}}),[l]),_=n.useRef(null),y=function(){var e,t,i=(e=function(){return new a},void 0===(t=n.useRef()).current&&(t.current={value:e()}),t.current.value);return n.useEffect((function(){return function(){return i.dispose()}}),[i]),i}();n.useEffect((()=>{r&&""!==r&&_&&y.requestAnimationFrame((()=>{var e;null===(e=_.current)||void 0===e||e.focus()}))}),[r,_,y]);var g=n.useCallback(((e,t)=>(i(null==t?void 0:t.data),!0)),[i]),b=n.useMemo((()=>{var e,n={};if(t&&t.length>0){var r=t[0],a={borderColor:f,color:r.textColor,backgroundColor:I,width:d,height:c};n.styles={root:a,rootHovered:a,rootPressed:{color:r.textColor},label:{textAlign:h},icon:{color:null!==(e=r.iconColor)&&void 0!==e?e:r.textColor}},n.iconProps={iconName:r.iconName},n.disabled=!0===o,n.text=r.iconOnly?"":r.name,n.onSelect=()=>{i(r)};var s=u(t.slice(1),!0===o,g);return s&&s.length>0&&(n.menuProps={shouldFocusOnContainer:!0,items:s}),n.onRenderMenuIcon=!1===m?()=>null:void 0,n}}),[o,c,t,h,g,i,m,d,I,f]);return n.createElement(s.ThemeProvider,{applyTo:"none",theme:v,className:"PowerCATFluentContextMenu"},n.createElement(s.DefaultButton,Object.assign({},b,{componentRef:_,tabIndex:p})))}));c.displayName="CanvasContextMenu";class m{constructor(){this.isTestHarness=!1,this.focusKey="",this.onSelect=e=>{e&&e.data&&this.context.parameters.items.openDatasetItem(e.data.getNamedReference())}}init(e,t){this.notifyOutputChanged=t,this.context=e,this.context.mode.trackContainerResize(!0),this.context.parameters.items.paging.setPageSize(500),this.isTestHarness=null!==document.getElementById("control-dimensions")}updateView(e){var t,o,r=this.context.parameters.InputEvent.raw;r&&this.inputEvent!==r&&r.startsWith("SetFocus")&&(this.focusKey=r);var a=e.parameters.items;(e.updatedProperties.indexOf("dataset")>-1||!this.items||this.isTestHarness)&&(this.items=function(e){if(e.error||void 0===e.paging.totalResultCount)return[l("1"),l("2"),l("3")];var t={};return e.sortedRecordIds.map((n=>{var i=e.records[n],o=i.getValue("ItemKey");return void 0!==t[o]?(t[o]++,o+="_".concat(t[o])):t[o]=1,{id:i.getRecordId(),key:o,name:i.getValue("ItemDisplayName"),enabled:i.getValue("ItemEnabled"),iconName:i.getValue("ItemIconName"),iconColor:i.getValue("ItemIconColor"),textColor:i.getValue("ItemTextColor"),borderColor:i.getValue("ItemBorderColor"),backgroundColor:i.getValue("ItemBackgroundColor"),parentItemKey:i.getValue("ItemParentKey"),iconOnly:i.getValue("ItemIconOnly"),checked:i.getValue("ItemChecked"),visible:i.getValue("ItemVisible"),data:i}}))}(a));var s=parseInt(e.mode.allocatedWidth),u=parseInt(e.mode.allocatedHeight),d=null!==(o=null===(t=e.accessibility)||void 0===t?void 0:t.assignedTabIndex)&&void 0!==o?o:void 0,m=e.parameters.TextAlignment.raw,h={tabIndex:d,width:s,height:u,items:this.items,onSelected:this.onSelect,disabled:e.mode.isControlDisabled,setFocus:this.focusKey,themeJSON:e.parameters.Theme.raw,showChevron:!1!==this.context.parameters.Chevron.raw,backgroundColor:this.context.parameters.BackgroundColor.raw,borderColor:this.context.parameters.BorderColor.raw,justify:i[m]};return n.createElement(c,h)}getOutputs(){return{}}destroy(){}}pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=t})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.ContextMenu', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.ContextMenu);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.ContextMenu = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.ContextMenu;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}