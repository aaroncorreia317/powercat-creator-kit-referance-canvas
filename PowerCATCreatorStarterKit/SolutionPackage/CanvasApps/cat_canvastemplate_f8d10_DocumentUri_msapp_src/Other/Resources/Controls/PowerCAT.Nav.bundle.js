/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={d:(t,i)=>{for(var n in i)e.o(i,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:i[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Nav:()=>l});const i=React;var n=void 0;try{n=window}catch(e){}function a(e){if(void 0!==n){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:n}}var r=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var i=this,n=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),n=setTimeout((function(){try{i._timeoutIds&&delete i._timeoutIds[n],e.apply(i._parent)}catch(e){i._logError(e)}}),t),this._timeoutIds[n]=!0),n},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var i=this,n=0,r=a(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),n=r.setTimeout((function(){try{i._immediateIds&&delete i._immediateIds[n],e.apply(i._parent)}catch(e){i._logError(e)}}),0),this._immediateIds[n]=!0),n},e.prototype.clearImmediate=function(e,t){var i=a(t);this._immediateIds&&this._immediateIds[e]&&(i.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var i=this,n=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),n=setInterval((function(){try{e.apply(i._parent)}catch(e){i._logError(e)}}),t),this._intervalIds[n]=!0),n},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,i){var n=this;if(this._isDisposed)return this._noop;var a,r,o=t||0,s=!0,l=!0,d=0,m=null;i&&"boolean"==typeof i.leading&&(s=i.leading),i&&"boolean"==typeof i.trailing&&(l=i.trailing);var u=function t(i){var u=Date.now(),c=u-d,p=s?o-c:o;return c>=o&&(!i||s)?(d=u,m&&(n.clearTimeout(m),m=null),a=e.apply(n._parent,r)):null===m&&l&&(m=n.setTimeout(t,p)),a};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r=e,u(!0)}},e.prototype.debounce=function(e,t,i){var n=this;if(this._isDisposed){var a=function(){};return a.cancel=function(){},a.flush=function(){return null},a.pending=function(){return!1},a}var r,o,s=t||0,l=!1,d=!0,m=null,u=0,c=Date.now(),p=null;i&&"boolean"==typeof i.leading&&(l=i.leading),i&&"boolean"==typeof i.trailing&&(d=i.trailing),i&&"number"==typeof i.maxWait&&!isNaN(i.maxWait)&&(m=i.maxWait);var h=function(e){p&&(n.clearTimeout(p),p=null),c=e},y=function(t){h(t),r=e.apply(n._parent,o)},f=function e(t){var i=Date.now(),a=!1;t&&(l&&i-u>=s&&(a=!0),u=i);var o=i-u,h=s-o,f=i-c,I=!1;return null!==m&&(f>=m&&p?I=!0:h=Math.min(h,m-f)),o>=s||I||a?y(i):null!==p&&t||!d||(p=n.setTimeout(e,h)),r},I=function(){return!!p},v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o=e,f(!0)};return v.cancel=function(){I()&&h(Date.now())},v.flush=function(){return I()&&y(Date.now()),r},v.pending=I,v},e.prototype.requestAnimationFrame=function(e,t){var i=this,n=0,r=a(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var o=function(){try{i._animationFrameIds&&delete i._animationFrameIds[n],e.apply(i._parent)}catch(e){i._logError(e)}};n=r.requestAnimationFrame?r.requestAnimationFrame(o):r.setTimeout(o,0),this._animationFrameIds[n]=!0}return n},e.prototype.cancelAnimationFrame=function(e,t){var i=a(t);this._animationFrameIds&&this._animationFrameIds[e]&&(i.cancelAnimationFrame?i.cancelAnimationFrame(e):i.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}();const o=FluentUIReactv8290;(0,o.initializeIcons)();var s=i.memo((e=>{var t,n,{items:a,onSelected:s,nestedItems:l,ariaLabel:d,selectedKey:m,setFocus:u,themeJSON:c,height:p,width:h,collapseByDefault:y}=e,[f,I]=i.useState([]),v=(t=m,n=(0,i.useRef)(),(0,i.useEffect)((function(){n.current=t})),n.current),[_,g]=i.useState(!1),k=i.useCallback(((e,t,i)=>{var n,r=!1;if(i){e="true"===(null===i.currentTarget.ariaExpanded?null===(n=i.currentTarget.previousElementSibling)||void 0===n?void 0:n.ariaExpanded:i.currentTarget.ariaExpanded);var o=a.find((e=>e.key===t));o&&s(o)}if(e){var l=f.indexOf(t);l>-1&&f.splice(l,1),r=!0}else-1===f.indexOf(t)&&(f.push(t),r=!0);r&&I([...f])}),[a,s,f,I]),b=i.useMemo((()=>{return l.map((t=>Object.assign({key:t.key},null!=t.links&&{links:e(null==t?void 0:t.links)})));function e(i){return i.map((i=>{return Object.assign(Object.assign({key:i.key,name:i.name,disabled:!1===i.enabled},null==i.links&&null!=i.iconName&&{iconProps:(n=i.iconName,a=i.iconColor,{iconName:n,styles:{root:{color:a}}})}),null!=i.links&&{links:e(null==i?void 0:i.links),expandAriaLabel:i.name.concat(" expanded"),collapseAriaLabel:i.name.concat(" collapsed"),isExpanded:t(i)});var n,a}))}function t(e){var t=e.isExpanded,i=null!=t?t:!y;return f.length>0&&(i=f.indexOf(e.key)>-1),i}}),[l,f,y]),x=i.useMemo((()=>{try{return c?(0,o.createTheme)(JSON.parse(c)):void 0}catch(e){console.error("Cannot parse theme",e)}}),[c]),E=i.useRef(null),K=function(){var e,t,n=(e=function(){return new r},void 0===(t=i.useRef()).current&&(t.current={value:e()}),t.current.value);return i.useEffect((function(){return function(){return n.dispose()}}),[n]),n}();i.useEffect((()=>{u&&""!==u&&E&&K.requestAnimationFrame((()=>{var e;null===(e=E.current)||void 0===e||e.focus()}))}),[u,E,K]);var S=i.useMemo((()=>({root:{width:h,height:p,boxSizing:"border-box",overflowY:"auto"},link:{whiteSpace:"normal",lineHeight:"inherit"},groupContent:{marginBottom:1},chevronButton:{"background-color":"transparent","::after":{content:"none"}}})),[h,p]),w=i.useCallback(((e,t)=>{var i=t&&a.find((e=>e.key===(null==t?void 0:t.key)));i&&s(i)}),[a,s]);return i.useEffect((()=>{if(v!==m){var e=a.find((e=>e.key===m));e&&e.parentItemKey&&k(!1,e.parentItemKey)}}),[m,_,a,k,v]),i.useEffect((()=>{var e,t=a.find((e=>e.key===m));!_&&l.length&&(a.filter((e=>!1!==e.visible)).map((e=>{(!1!==e.isExpanded&&!y||!0===e.isExpanded)&&k(!1,e.key)})),(e=a.find((e=>e.key===(null==t?void 0:t.key))))&&function t(i){k(!1,i.key),(e=a.find((e=>e.key===(null==i?void 0:i.parentItemKey))))&&t(e)}(e),g(!0))}),[m,_,a,l,y,k,v]),i.createElement(o.ThemeProvider,{applyTo:"none",theme:x},i.createElement(o.Nav,{componentRef:E,onLinkClick:w,onLinkExpandClick:(e,t)=>{t&&void 0!==t.key&&k(!1,t.key,e)},selectedKey:m,styles:S,groups:b,ariaLabel:d}))}));s.displayName="CanvasNav";class l{constructor(){this.focusKey="",this.onSelectCalled=!1,this.onSelect=(e,t)=>{void 0!==t&&!0!==t||(this.lastSelected=e,this.notifyOutputChanged()),e&&e.data&&(this.onSelectCalled=!0,this.context.parameters.items.openDatasetItem(e.data.getNamedReference()))}}init(e,t){this.notifyOutputChanged=t,this.context=e,this.context.mode.trackContainerResize(!0),this.context.parameters.items.paging.setPageSize(500)}updateView(e){var t,n,a,r,o,l,d,m=this.context.parameters.InputEvent.raw;m&&this.inputEvent!==m&&m.startsWith("SetFocus")&&(this.focusKey=m);var u=null!==(n=null===(t=e.parameters)||void 0===t?void 0:t.AccessibilityLabel.raw)&&void 0!==n?n:"",c=e.parameters.items;(e.updatedProperties.indexOf("dataset")>-1||!this.items)&&(this.items=function(e){return e.error||void 0===e.paging.totalResultCount?[{id:"1",key:"1",name:"Item 1"},{id:"2",key:"2",name:"Item 2",isExpanded:!0},{id:"3",key:"3",name:"Item 3",isExpanded:!0},{id:"4",key:"4",name:"Item 4",visible:!1},{id:"5",key:"5",name:"Item 5",parentItemKey:"3"},{id:"6",key:"6",name:"Item 6",parentItemKey:"2",isExpanded:!1},{id:"7",key:"7",name:"Item 7",parentItemKey:"6"},{id:"8",key:"8",name:"Item 8",parentItemKey:"7",isExpanded:!0},{id:"9",key:"9",name:"Item 9",parentItemKey:"8"},{id:"10",key:"10",name:"Item 10",parentItemKey:"9",isExpanded:!0},{id:"11",key:"11",name:"Item 11"},{id:"12",key:"12",name:"Item 12"},{id:"13",key:"13",name:"Item 13",parentItemKey:"12"},{id:"14",key:"14",name:"Item 14",parentItemKey:"12"},{id:"15",key:"15",name:"Item 12",parentItemKey:"15"}]:e.sortedRecordIds.map((t=>{var i=e.records[t];return{id:i.getRecordId(),key:i.getValue("ItemKey"),name:i.getValue("ItemDisplayName"),enabled:i.getValue("ItemEnabled"),iconName:i.getValue("ItemIconName"),iconColor:i.getValue("ItemIconColor"),parentItemKey:i.getValue("ItemParentKey"),visible:i.getValue("ItemVisible"),isExpanded:i.getValue("ItemExpanded"),data:i}}))}(c),this.nestedItems=this.items.length>0?function(e){var t=[],i="rootID".concat(e[0].key,e[e.length-1].key);e.map((t=>{void 0!==t.parentItemKey?-1===e.map((e=>e.key)).indexOf(t.parentItemKey)&&(t.parentItemKey=i):t.parentItemKey=i})),e.unshift({id:i,name:i,key:i,parentItemKey:null});var n=e.reduce(((e,t,i)=>(e[t.key]=i,e)),{});return e.map((i=>{if(null!=i.parentItemKey){if(!1!==e[n[i.key]].visible){var a=e[n[i.parentItemKey]];a.links=[...a.links||[],i]}}else t=[i]})),t}(this.items):[],this.onSelectCalled=!1),this.checkSelectedKeyChanged(e);var p=parseInt(e.mode.allocatedWidth),h=parseInt(e.mode.allocatedHeight),y={tabIndex:null!==(r=null===(a=e.accessibility)||void 0===a?void 0:a.assignedTabIndex)&&void 0!==r?r:void 0,width:p,height:h,items:this.items,ariaLabel:u,nestedItems:this.nestedItems,onSelected:this.onSelect,disabled:e.mode.isControlDisabled,selectedKey:null!==(o=e.parameters.SelectedKey.raw)&&void 0!==o?o:"",setFocus:this.focusKey,themeJSON:e.parameters.ThemeJSON.raw,collapseByDefault:null!==(d=null===(l=e.parameters)||void 0===l?void 0:l.CollapseByDefault.raw)&&void 0!==d&&d};return i.createElement(s,y)}getOutputs(){var e,t;return{SelectedKey:null!==(t=null===(e=this.lastSelected)||void 0===e?void 0:e.key)&&void 0!==t?t:null}}destroy(){}checkSelectedKeyChanged(e){var t,i=e.parameters.SelectedKey.raw,n=e.updatedProperties.indexOf("SelectedKey")>-1,a=(null===(t=this.lastSelected)||void 0===t?void 0:t.key)!==i;if(!this.onSelectCalled&&void 0!==i||n&&a){var r=this.items.find((e=>e.key===i));this.onSelect(r,!1)}}}pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=t})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.Nav', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.Nav);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.Nav = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.Nav;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}