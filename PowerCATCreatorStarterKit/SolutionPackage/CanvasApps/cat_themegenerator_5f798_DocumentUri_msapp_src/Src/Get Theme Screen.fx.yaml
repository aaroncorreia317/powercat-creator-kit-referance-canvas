"'Get Theme Screen' As screen":
    Fill: =
    LoadingSpinnerColor: =RGBA(0, 120, 212, 1)
    OnVisible: =

    RootLayoutContainer_TS_2 As groupContainer.verticalAutoLayoutContainer:
        Fill: =RGBA(250, 250, 250, 1)
        Height: =App.Height
        LayoutAlignItems: =LayoutAlignItems.Center
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: ='Get Theme Screen'.Width
        Y: =
        ZIndex: =1

        PowerCATHeader_TS_2 As Header:
            AlignInContainer: =AlignInContainer.Stretch
            ContentWidth: =DesiredMaxWidth
            Height: =70
            LayoutMinHeight: =640
            LayoutMinWidth: =640
            RightButtonVisible: =false
            Styles: |-
                =Table({Name: "PrimaryColor1Value", Value: "#ffffff"},
                {Name: "PrimaryColor1TextValue", Value: "#ffffff"},
                {Name: "PrimaryColor2Value", Value: "#0078d4"},
                {Name: "PrimaryColor2TextValue", Value: "#ffffff"},
                {Name: "PrimaryColor3Value", Value: "#303030"},
                {Name: "PrimaryColor3TextValue", Value: "#080808"},
                {Name: "PrimaryColor4Value", Value: "#006e7d"},
                {Name: "defaultLabelColorValue", Value: "#ffffff"},
                {Name: "RadiusValue", Value: "0"},
                {Name: "TextBodyFontFaceValue", Value: "Segoe UI" },
                {Name: "PaddingValue", Value: "20"},
                {Name: "TextEmphasisFontSizeValue", Value: "16"},
                {Name: "TextEmphasisFontSizePhoneValue", Value: "24"},
                {Name: "TextBodyFontSizeValue", Value: "14"},
                {Name: "TextBodyFontSizePhoneValue", Value: "21"},
                {Name: "BackgroundColorValue", Value: AppTheme.palette.themePrimary},
                {Name: "BorderThicknessValue", Value: "0"},
                {Name: "BorderColorValue", Value: "#FFFFFF"},
                {Name: "FocusedBorderThicknessValue", Value: "0"},
                {Name: "BackgroundColorValue", Value :"#FFFFFF"},
                {Name: "FontWeightValue", Value: "600"}
                )
            Text: ="Theme Designer"
            Visible: =true
            ZIndex: =1

        RootContainer As groupContainer.horizontalAutoLayoutContainer:
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            LayoutWrap: =true
            Width: =RootLayoutContainer_TS_2.Width
            ZIndex: =4

            MainContainer As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =White
                Height: =900
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMinHeight: =100
                LayoutMinWidth: =200
                LayoutMode: =LayoutMode.Auto
                PaddingRight: =10
                Width: =RootContainer.Width * 0.8
                ZIndex: =1

                FluentThemeDesigner2 As FluentThemeDesigner:
                    AlignInContainer: =AlignInContainer.Stretch
                    BackgroundColor: =
                    DisplayMode: =DisplayMode.Edit
                    FillPortions: =1
                    Height: =200
                    LayoutMinHeight: =250
                    LayoutMinWidth: =200
                    OnChange: |-
                        =// Final Theme JSON
                        Set(
                            AppThemeJson,
                            Concatenate(
                                "{" & Char(34) & "palette" & Char(34) & " : ",
                                FluentThemeDesigner2.ThemeJSON,
                                "}"
                            )
                        );
                        // Final Theme JSON - Without Palette string
                        Set(
                            ThemeJSON,
                            FluentThemeDesigner2.ThemeJSON
                        );
                        // Gathering individual key value pair from theme json in a table
                        ClearCollect(
                            varThemeProperties,
                            MatchAll(
                                ThemeJSON,
                                "(?:\""|\')(?<key>[\w\d]+)(?:\""|\')(?:\:\s*)(?:\""|\')?(?<value>[\^#\w\s-]*)(?:\""|\')?"
                            )
                        );
                        // Forming JSON which can be copied
                        Set(
                            varThemeJSONStr,
                            Concat(
                                varThemeProperties,
                                Concatenate(
                                    key,
                                    " : """,
                                    value,
                                    """, "
                                )
                            )
                        );
                        Set(
                            themeJSONLength,
                            Len(varThemeJSONStr)
                        );
                        Set(
                            FinalThemeJSON,
                            If(
                                CountRows(varThemeProperties) > 1,
                                Concatenate(
                                    "{ palette : { ",
                                    Replace(
                                        varThemeJSONStr,
                                        themeJSONLength - 1,
                                        1,
                                        ""
                                    ),
                                    "} }"
                                ),
                                "Please select color(s) to generate theme !"
                            )
                        )
                    PrimaryColor: =
                    TextColor: =
                    Width: =MainContainer.Width-50
                    X: =0
                    Y: =0
                    ZIndex: =2

            SideContainer As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 120, 212, 1)
                Fill: =RGBA(255, 255, 255, 1)
                FillPortions: =0
                Height: =0
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                Width: =RootContainer.Width*0.2
                ZIndex: =2

                tblThemeValue As dataTable.datatable:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.Solid
                    Color: =RGBA(51, 51, 51, 1)
                    DisabledColor: =RGBA(166, 166, 166, 1)
                    DisplayMode: =DisplayMode.Edit
                    Fill: =RGBA(0, 0, 0, 0)
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Normal
                    HeadingColor: =RGBA(255, 255, 255, 1)
                    HeadingFill: =RGBA(0, 120, 212, 1)
                    HeadingFont: =Font.'Segoe UI'
                    HeadingFontWeight: =FontWeight.Normal
                    HeadingSize: =13
                    Height: =500
                    HoverColor: =RGBA(255, 255, 255, 1)
                    HoverFill: =RGBA(0, 120, 212, 1)
                    InputFill: =RGBA(255, 255, 255, 1)
                    InvertedColor: =RGBA(255, 255, 255, 1)
                    Items: =varThemeProperties
                    LinkColor: =RGBA(0, 134, 208, 1)
                    PrimaryColor1: =RGBA(0, 120, 212, 1)
                    PrimaryColor2: =ColorFade(RGBA(0, 120, 212, 1), -30%)
                    PrimaryColor3: =ColorFade(RGBA(0, 120, 212, 1), -50%)
                    SelectedColor: =RGBA(51, 51, 51, 1)
                    SelectedFill: =RGBA(0, 120, 212, .2)
                    Size: =13
                    Width: =800
                    X: =0
                    Y: =440
                    ZIndex: =4

    tblProperties As dataTable.datatable:
        BorderColor: =RGBA(0, 0, 0, 0)
        BorderStyle: =BorderStyle.Solid
        Color: =RGBA(51, 51, 51, 1)
        DisabledColor: =RGBA(166, 166, 166, 1)
        DisplayMode: =DisplayMode.Edit
        Fill: =RGBA(0, 0, 0, 0)
        Font: =Font.'Segoe UI'
        FontWeight: =FontWeight.Normal
        HeadingColor: =RGBA(255, 255, 255, 1)
        HeadingFill: =RGBA(0, 120, 212, 1)
        HeadingFont: =Font.'Segoe UI'
        HeadingFontWeight: =FontWeight.Normal
        HeadingSize: =13
        Height: =SideContainer.Height * .35
        HoverColor: =RGBA(255, 255, 255, 1)
        HoverFill: =RGBA(0, 120, 212, 1)
        InputFill: =RGBA(255, 255, 255, 1)
        InvertedColor: =RGBA(255, 255, 255, 1)
        Items: =varThemeProperties
        LinkColor: =RGBA(0, 134, 208, 1)
        PrimaryColor1: =RGBA(0, 120, 212, 1)
        PrimaryColor2: =ColorFade(RGBA(0, 120, 212, 1), -30%)
        PrimaryColor3: =ColorFade(RGBA(0, 120, 212, 1), -50%)
        SelectedColor: =RGBA(51, 51, 51, 1)
        SelectedFill: =RGBA(0, 120, 212, .2)
        Size: =13
        Width: =SideContainer.Width * .98
        X: =SideContainer.X
        Y: =694
        ZIndex: =2

        key_Column2 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="key"
            FieldName: ="key"
            FieldVariantName: ="textualColumn"
            Height: =535
            LayoutHeight: =Parent.Height
            Order: =1
            Text: =ThisItem.key
            Width: =199
            X: =402
            Y: =0
            ZIndex: =5

        value_Column2 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="value"
            FieldName: ="value"
            FieldVariantName: ="textualColumn"
            Height: =535
            LayoutHeight: =Parent.Height
            Order: =2
            Text: =ThisItem.value
            Width: =191
            X: =402
            Y: =0
            ZIndex: =6

    txtEditorThemeJSON As richTextEditor:
        BorderColor: =RGBA(166, 166, 166, 1)
        Default: =FinalThemeJSON
        EnableSpellCheck: =false
        Height: =SideContainer.Height*.60
        Width: =SideContainer.Width * .98
        X: =SideContainer.X
        Y: =75
        ZIndex: =3

